<html lang="ko">
  <head>
    <title>주소 찾기</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"/>
  </head>
  <body onload="execDaumPostcode()">
  <div id = "layer" style = "display:block; position:absolute; overflow:hidden; z-index:1; -webkit-overflow-scrolling:touch; ">
  </div>
  <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=763b02e8c0856fc7e8d378ca4a4f614a&libraries=services" type="text/javascript"></script>
  <script src="https://spi.maps.daum.net/imap/map_js_init/postcode.v2.js"></script>
  <script>
    window.addEventListener("message", onReceivedPostMessage, false);

    function postMessageToiOS(postData) {
        window.webkit.messageHandlers.callBackHandler.postMessage(postData);
    }

    var element_layer = document.getElementById('layer');
    function execDaumPostcode() {
      new daum.Postcode({
        oncomplete: function(data) {
          var jibunAddress = ""
          var lat = ""
          var lng = ""
          
          if (data.jibunAddress == "") {
            jibunAddress = data.autoJibunAddress
          } else if (data.autoJibunAddress == "") {
            jibunAddress = data.jibunAddress
          }

          // const geocoder = new kakao.maps.services.Geocoder();
          // geocoder.addressSearch(data.roadAddress, (result, status) => {
          // if (status === kakao.maps.services.Status.OK) {
          //   lat = result[0].y
          //   lng = result[0].x
          //   console.log('위도 : ' + result[0].y);
          //   console.log('경도 : ' + result[0].x);
          // }
          // });
          var postData = {
              roadAddress : data.roadAddress,
              jibunAddress : jibunAddress,
              zonecode : data.zonecode,
              lat : lat,
              lng : lng
          };
          window.postMessageToiOS(postData);
        },
        width : '100%',
        height : '100%'
      }).embed(element_layer);
      element_layer.style.display = 'block';
      initLayerPosition();
    }

    function initLayerPosition(){
      var width = (window.innerWidth || document.documentElement.clientWidth);
      var height = (window.innerHeight || document.documentElement.clientHeight);
      element_layer.style.width = width + 'px';
      element_layer.style.height = height + 'px';
      element_layer.style.left = (((window.innerWidth || document.documentElement.clientWidth) - width)/2) + 'px';
      element_layer.style.top = (((window.innerHeight || document.documentElement.clientHeight) - height)/2) + 'px';
    }
  </script>
  </body>
</html>
